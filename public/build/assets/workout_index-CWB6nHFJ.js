import{s as x}from"./swal-Bt6ici_8.js";import{n as s}from"./notyf-D_y3dwLD.js";import"./jquery-CP0fMIbo.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./sweetalert2.all-B9kxGEux.js";import"./notyf.min-DaJKEBVE.js";let e,p=$("#wizard_selection").data("workout-price"),t=1,m=$("#wizard-cart-list"),b=m.find("#cart-workouts"),c=m.find("#cart-reduction"),v=m.find("#cart-total");$("#wizard-workout-increment");let l=$("#wizard-workout-decrement"),z=$("#workout-display-text"),F=$("#workout-display-price"),d=$("#cart-reduction-form"),n=$("#cart-payment-form"),P=n.find('input[type="hidden"]#workouts'),R=n.find('input[type="hidden"]#reduction_id'),B=n.find('input[type="hidden"]#total_price'),i=0;$(document).ready(function(){setTimeout(function(){$("#smartwizard").smartWizard("goToStep",0),$("#smartwizard").find(".nav-link").removeClass("done"),l.prop("disabled",!0),C(),k()},0),$(document).on("click","#wizard-workout-increment",function(){t++,f(),t>1&&l.prop("disabled",!1)}),$(document).on("click","#wizard-workout-decrement",function(){t>1?(t--,f(),t===1&&l.prop("disabled",!0)):s.error("Vous devez sélectionner au moins une séance.")}),$(document).on("submit","#cart-reduction-form",function(a){a.preventDefault();let r=$(this),u=r.serialize();r.find('button[type="submit"]'),y(),$.ajax({url:r.attr("action"),type:r.attr("method"),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:u}).done(function(o){switch(o.status){case"success":e=o.reduction,w(),r.css("display","none"),$("#cart-reduction-remove").css("display","block");break;case"error":s.error(o.message);break;default:s.error("Une erreur est survenue lors de la validation du code promo.");break}}).fail(function(o){o.responseJSON?s.error(o.responseJSON.message??"Une erreur est survenue !"):s.error("Une erreur est survenue !")}).always(function(){r.find("input").val(""),k()})}),$(document).on("click","#cart-reduction-remove",function(){e=null,w(),$("#cart-reduction-form").css("display","block"),$(this).css("display","none")}),$(document).on("submit","#cart-payment-form",function(a){S(),y()}),$("#smartwizard").on("leaveStep",function(a,r,u,o,W){if(u===0&&t===0)return x.fire({icon:"error",title:"Sélection de séance",text:"Veuillez sélectionner au moins une séance pour continuer.",showConfirmButton:!1,showCancelButton:!1,timer:2500}),!1;f()})});function f(){z.text(t),F.text(t*p+" €"),b.find(".subtitle").text(t+" séance"+(t>1?"s":"")),b.find(".price").text(t*p+" €"),h()}function w(){e?(c.find(".subtitle").text(e.code),c.find(".price").text("-"+e.percentage+" %"),c.css("display","flex")):c.hide(),h()}function y(){d.find('button[type="submit"]').prop("disabled",!0),d.find("span.cart-form-text").hide(),d.find("span.cart-form-loader").show()}function k(){d.find('button[type="submit"]').prop("disabled",!1),d.find("span.cart-form-text").show(),d.find("span.cart-form-loader").hide()}function C(){n.find('button[type="submit"]').prop("disabled",!1),n.find("span.span-form-text").css("display","flex"),n.find("span.span-form-loader").hide()}function S(){n.find('button[type="submit"]').prop("disabled",!0),n.find("span.span-form-text").hide(),n.find("span.span-form-loader").show()}function h(){i=t*p,e&&(i=i-i*e.percentage/100),i=Math.round(i*100)/100;let a=i;v.find(".price").text(a+" €"),P.val(t),R.val(e?e.id:""),B.val(a)}
